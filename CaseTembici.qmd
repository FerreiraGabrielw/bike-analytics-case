---
title: "Hybrid Recommender System for E-commerce (End-to-End)"
author: "Gabriel Ferreira"
date: "2025-12-19"
format:
  html:
    page-layout: full
    code-fold: true
    code-summary: "Show Code"
    toc: true
    toc-depth: 1
    toc-title: "Project Index"
    anchor-sections: false
engine: knitr
jupyter: ir
---




COMEÃ‡A AQUI !!!!!!!!!!

# EDA (Exploratory Data Analysis)

```{r}
#| include: false
#| message: false
#| warning: false

library(tidyverse)
library(lubridate)
library(scales)
library(ggplot2)
library(DT)
```

---

# Carga e tratamento dos dados:

```{r}
df <- read_csv("data/viagens_consolidadas.csv")

df <- df %>%
  mutate(
    start_time = ymd_hms(start_time),
    end_time   = ymd_hms(end_time),
    date       = as_date(start_time),
    duration_min = duration_seconds / 60,
    receita = as.numeric(valor_total_fatura),
    erro = qtd_erros_unlock > 0
  )
```


##### KPIs principais:
```{r}
total_viagens <- nrow(df)

usuarios_ativos <- df %>%
  filter(!is.na(user_id)) %>%
  summarise(n = n_distinct(user_id)) %>%
  pull(n)

duracao_media <- mean(df$duration_min, na.rm = TRUE)
receita_total <- sum(df$receita, na.rm = TRUE)
receita_media <- mean(df$receita, na.rm = TRUE)
taxa_erro <- mean(df$erro, na.rm = TRUE)
```

##### Layout dos KPIs (cards):

```markdown
## ðŸ“Š VisÃ£o Geral

::: {.grid}
::: {.g-col-2}
**Total de Viagens**  
### `r comma(total_viagens)`
:::

::: {.g-col-2}
**UsuÃ¡rios Ativos**  
### `r comma(usuarios_ativos)`
:::

::: {.g-col-2}
**DuraÃ§Ã£o MÃ©dia (min)**  
### `r round(duracao_media, 1)`
:::

::: {.g-col-2}
**Receita Total**  
### R$ `r comma(receita_total, accuracy = 0.01)`
:::

::: {.g-col-2}
**Receita MÃ©dia**  
### R$ `r comma(receita_media, accuracy = 0.01)`
:::

::: {.g-col-2}
**Taxa de Erro**  
### `r percent(taxa_erro, accuracy = 0.1)`
:::
:::

##### AgregaÃ§Ãµes diÃ¡rias:
```{r}
daily <- df %>%
  group_by(date) %>%
  summarise(
    viagens = n(),
    receita = sum(receita, na.rm = TRUE),
    erros   = sum(erro, na.rm = TRUE)
  )
```

#### GrÃ¡ficos:

##### Viagens por dia:
```{r}
ggplot(daily, aes(date, viagens)) +
  geom_line(linewidth = 1) +
  labs(
    title = "Viagens por Dia",
    x = NULL,
    y = "Total de Viagens"
  ) +
  theme_minimal()
```

##### Receita por dia:
```{r}
ggplot(daily, aes(date, receita)) +
  geom_line(linewidth = 1) +
  scale_y_continuous(labels = dollar_format(prefix = "R$ ")) +
  labs(
    title = "Receita por Dia",
    x = NULL,
    y = "Receita"
  ) +
  theme_minimal()
```


##### Erros por dia:
```{r}
ggplot(daily, aes(date, erros)) +
  geom_col() +
  labs(
    title = "Erros por Dia",
    x = NULL,
    y = "Qtd de Erros"
  ) +
  theme_minimal()
```


```{r}



```
